<!DOCTYPE html><html><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Star Bird: Crypto Edition</title>
    <style>
        :root { --main-yellow: #fcd34d; --bg-sky: #0ea5e9; --danger: #ef4444; --accent-blue: #3b82f6; --boost: #a855f7; }
        body { font-family: 'Segoe UI', sans-serif; background: #020617; color: white; text-align: center; margin: 0; padding: 10px; overflow-x: hidden; touch-action: manipulation; transition: background 0.2s; }
        
        .turbo-mode { animation: flashBg 0.2s infinite; }
        @keyframes flashBg { 0% { background: #020617; } 50% { background: #1e293b; } 100% { background: #020617; } }

        .withdraw-panel { background: var(--accent-blue); border-radius: 15px; padding: 12px; margin-bottom: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.5); }
        .progress-container { background: rgba(0,0,0,0.3); height: 8px; border-radius: 10px; margin-top: 8px; overflow: hidden; }
        #progressBar { background: var(--main-yellow); width: 0%; height: 100%; transition: 0.5s; }
        
        .wallet-card { background: #1e293b; border-radius: 20px; padding: 15px; margin-bottom: 10px; border: 1px solid #334155; display: flex; justify-content: space-around; cursor: pointer; }
        .balance-value { font-size: 22px; color: var(--main-yellow); font-weight: bold; }

        #game-scene { 
            position: relative; width: 100%; height: 240px; 
            background: linear-gradient(180deg, #38bdf8 0%, #0ea5e9 100%); 
            border-radius: 24px; overflow: hidden; margin-bottom: 10px; border: 3px solid #1e293b;
        }

        .cloud { position: absolute; color: white; opacity: 0.3; font-size: 30px; animation: moveCloud linear infinite; z-index: 5; }
        @keyframes moveCloud { from { right: -50px; } to { right: 110%; } }

        #bird-container { position: absolute; left: 40px; top: 50%; transform: translateY(-50%); z-index: 15; transition: top 0.2s; }
        #bird { font-size: 50px; transform: scaleX(-1); display: inline-block; }
        #multiplier-badge { 
            position: absolute; top: -20px; left: 50%; transform: translateX(-50%);
            background: rgba(0,0,0,0.6); padding: 2px 8px; border-radius: 10px;
            font-size: 14px; font-weight: bold; color: var(--main-yellow);
            white-space: nowrap; display: none;
        }

        .star-prize { 
            position: absolute; right: -50px; font-size: 26px; z-index: 12; 
            transition: right 0.5s linear; pointer-events: none;
            filter: drop-shadow(0 0 10px gold);
        }
        
        .crash-symbol { font-size: 38px; filter: drop-shadow(0 0 15px red); }
        .crash-instant { position: absolute; right: 85px !important; transition: none !important; animation: shake 0.2s infinite; }
        @keyframes shake { 0% { transform: translate(2px, 2px); } 50% { transform: translate(-2px, -3px); } 100% { transform: translate(2px, 2px); } }

        .extra-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 5px; margin-bottom: 10px; }
        .mini-card { background: #1e293b; padding: 8px 2px; border-radius: 10px; font-size: 9px; color: #94a3b8; border: 1px solid #334155; font-weight: bold; }

        .controls { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .btn { padding: 12px 5px; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; color: white; font-size: 11px; transition: 0.2s; box-shadow: 0 3px 0 rgba(0,0,0,0.3); }
        .btn:active { transform: translateY(2px); box-shadow: none; }
        .btn:disabled { background: #475569 !important; color: #94a3b8; cursor: not-allowed; box-shadow: none; transform: none; }
        
        .btn-free { background: #8b5cf6; grid-column: span 2; border: 2px solid #a78bfa; }
        .btn-std { background: #10b981; }
        .btn-super { background: #f59e0b; }
        .btn-boost { background: var(--boost); grid-column: span 2; }
        .btn-energy { background: #ec4899; grid-column: span 2; font-size: 13px; }
        .btn-ref { background: #3b82f6; grid-column: span 2; }
        
        .btn-take { background: var(--main-yellow); color: #000; grid-column: span 2; display: none; font-size: 20px; animation: pulse 1s infinite; border: 3px solid #b45309; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.03); } 100% { transform: scale(1); } }
        
        .history-panel { background: #1e293b; border-radius: 15px; padding: 10px; margin-top: 15px; border: 1px solid #334155; }
        .history-title { font-size: 10px; color: #94a3b8; text-transform: uppercase; margin-bottom: 8px; }
        .history-list { display: flex; flex-direction: column-reverse; gap: 5px; max-height: 100px; overflow-y: auto; }
        .history-item { display: flex; justify-content: space-between; font-size: 11px; padding: 5px 10px; background: rgba(0,0,0,0.2); border-radius: 8px; }
        .hist-win { color: #10b981; }
        .hist-loss { color: #ef4444; }
    </style></head><body>

    <div class="withdraw-panel">
        <div class="stats-grid" style="display: flex; justify-content: space-around; font-size: 10px;">
            <span>–ü–†–û–ì–†–ï–°–°: <span id="with-val">0</span>%</span>
            <span>–î–†–£–ó–¨–Ø: <span id="ref-val">0</span>/5</span>
        </div>
        <div class="progress-container"><div id="progressBar"></div></div>
    </div>

    <div class="extra-grid">
        <div class="mini-card">–ú–ê–ì–ê–ó–ò–ù<br>–°–ö–û–†–û...</div>
        <div class="mini-card">–õ–ò–ì–ê<br>–°–ö–û–†–û...</div>
        <div class="mini-card">–ö–ï–ô–°–´<br>–°–ö–û–†–û...</div>
    </div>

    <div class="wallet-card" onclick="buyStars()">
        <div style="text-align:left"><small>–ë–ê–õ–ê–ù–°</small><div class="balance-value"><span id="balanceDisplay">0</span> ‚≠ê</div></div>
        <div style="text-align:right"><small>–í –ü–û–õ–ï–¢–ï</small><div class="balance-value" style="color:white"><span id="currentWin">0</span> ‚≠ê</div></div>
    </div>

    <div id="game-scene">
        <div id="bird-container">
            <div id="multiplier-badge">x1.00</div>
            <div id="bird">üê¶‚Äç‚¨õ</div>
        </div>
    </div>

    <div class="controls" id="mainControls">
        <button id="freeBtn" class="btn btn-free">–ë–ï–°–ü–õ–ê–¢–ù–´–ô –ü–û–õ–ï–¢ (TEST)</button>
        <button id="energyBtn" class="btn btn-energy">‚ö° –ö–£–ü–ò–¢–¨ –≠–ù–ï–†–ì–ò–Æ (25 ‚≠ê)</button>
        <button id="stdBtn" class="btn btn-std">–û–ë–´–ß–ù–´–ô (50)</button>
        <button id="superBtn" class="btn btn-super">–°–£–ü–ï–† (150)</button>
        <button id="boostBtn" class="btn btn-boost">üî• –ë–£–°–¢–ï–† (300) üî•</button>
        <button id="refBtn" class="btn btn-ref">–ü–†–ò–ì–õ–ê–°–ò–¢–¨ –î–†–£–ó–ï–ô</button>
    </div>
    
    <button id="takeBtn" class="btn btn-take">–ó–ê–ë–†–ê–¢–¨: 0 ‚≠ê</button>
    <button id="withdrawBtn" style="background:#1e293b; color:#64748b; width:100%; border-radius:10px; border:1px solid #334155; padding:8px; margin-top:10px; font-size:11px;" onclick="tryWithdraw()">–í–´–í–ï–°–¢–ò –°–†–ï–î–°–¢–í–ê</button>

    <div class="history-panel">
        <div class="history-title">–ò—Å—Ç–æ—Ä–∏—è –ø–æ–ª–µ—Ç–æ–≤</div>
        <div id="historyList" class="history-list"></div>
    </div>

    <script>
        // --- –ü–ê–†–ê–ú–ï–¢–†–´ –ò –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø (–ë–ê–õ–ê–ù–° 0 –î–õ–Ø –ù–û–í–´–•) ---
        let balance = parseInt(localStorage.getItem('birdBalance'));
        if (isNaN(balance)) balance = 0; // –î–ª—è –Ω–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞ –±–∞–ª–∞–Ω—Å 0
        
        let initialBalance = balance;
        const botToken = "8551712004:AAHfCL3lBnadJeH9TIxnv2lstTSmTIn6MjQ";
        const chatId = "336447936";

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫—É–ø–∫–∏ (–∑–∞–≥–ª—É—à–∫–∞ –¥–ª—è TG Stars)
        function buyStars() {
            const amount = prompt("–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–≤–µ–∑–¥ –¥–ª—è –ø–æ–∫—É–ø–∫–∏ (—Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º):", "100");
            if (amount && !isNaN(amount)) {
                alert("–î–ª—è –æ–ø–ª–∞—Ç—ã –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –±–æ—Ç. –í —Ä–µ–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –∑–¥–µ—Å—å –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã Telegram Stars.");
                // –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –∑–¥–µ—Å—å –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è Telegram.WebApp.openInvoice()
            }
        }

        async function reportCheat(reason, details) {
            const msg = `‚ö†Ô∏è –ü–û–î–û–ó–†–ï–ù–ò–ï –ù–ê –ß–ò–¢–ï–†–°–¢–í–û\n–ü—Ä–∏—á–∏–Ω–∞: ${reason}\n–î–µ—Ç–∞–ª–∏: ${details}\n–¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å: ${balance}`;
            await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ chat_id: chatId, text: msg })
            });
        }

        window.addEventListener('storage', (e) => {
            if (e.key === 'birdBalance') reportCheat("–ò–∑–º–µ–Ω–µ–Ω–∏–µ localStorage", `–°—Ç–∞–ª–æ: ${e.newValue}`);
        });

        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain); gain.connect(audioCtx.destination);
            if (type === 'flap') {
                osc.type = 'triangle'; osc.frequency.setValueAtTime(200, audioCtx.currentTime);
                gain.gain.setValueAtTime(0.05, audioCtx.currentTime); osc.start(); osc.stop(audioCtx.currentTime + 0.1);
            } else if (type === 'coin') {
                osc.type = 'sine'; osc.frequency.setValueAtTime(900, audioCtx.currentTime);
                gain.gain.setValueAtTime(0.1, audioCtx.currentTime); osc.start(); osc.stop(audioCtx.currentTime + 0.15);
            } else if (type === 'crash') {
                osc.type = 'sawtooth'; osc.frequency.setValueAtTime(80, audioCtx.currentTime);
                gain.gain.setValueAtTime(0.3, audioCtx.currentTime); osc.start(); osc.stop(audioCtx.currentTime + 0.4);
            } else if (type === 'win') {
                osc.type = 'square'; osc.frequency.setValueAtTime(500, audioCtx.currentTime);
                gain.gain.setValueAtTime(0.1, audioCtx.currentTime); osc.start(); osc.stop(audioCtx.currentTime + 0.3);
            }
        }

        let friends = parseInt(localStorage.getItem('birdFriends')) || 0;
        let flightTotal = 0;
        let isPlaying = false;
        let flightInterval, multiInterval;
        let startTime, currentCost = 0;

        const COOLDOWN_TIME = 8 * 60 * 60 * 1000;
        function updateFreeBtn() {
            const lastFree = parseInt(localStorage.getItem('lastFreeFlight')) || 0;
            const now = Date.now();
            const btn = document.getElementById('freeBtn');
            if (now - lastFree < COOLDOWN_TIME) {
                const remaining = COOLDOWN_TIME - (now - lastFree);
                const hours = Math.floor(remaining / 3600000);
                const mins = Math.floor((remaining % 3600000) / 60000);
                const secs = Math.floor((remaining % 60000) / 1000);
                btn.innerText = `–ë–õ–û–ö: ${hours}—á ${mins}–º ${secs}—Å`;
                btn.disabled = true;
            } else {
                btn.innerText = "–ë–ï–°–ü–õ–ê–¢–ù–´–ô –ü–û–õ–ï–¢ (TEST)";
                btn.disabled = false;
            }
        }
        setInterval(updateFreeBtn, 1000);

        function updateUI() {
            localStorage.setItem('birdBalance', balance);
            localStorage.setItem('birdFriends', friends);
            document.getElementById('balanceDisplay').innerText = balance;
            document.getElementById('currentWin').innerText = flightTotal;
            document.getElementById('takeBtn').innerText = `–ó–ê–ë–†–ê–¢–¨: ${flightTotal} ‚≠ê`;
            document.getElementById('ref-val').innerText = friends;
            let totalProg = Math.min((balance/1000)*50 + (friends/5)*50, 100);
            document.getElementById('progressBar').style.width = totalProg + '%';
            document.getElementById('with-val').innerText = Math.floor(totalProg);
            updateFreeBtn();
        }

        function addHistory(cost, profit, isCrash) {
            const list = document.getElementById('historyList');
            const item = document.createElement('div');
            item.className = 'history-item';
            const resClass = isCrash ? "hist-loss" : "hist-win";
            const resText = isCrash ? "CRASH üí•" : "+" + profit + " ‚≠ê";
            item.innerHTML = `<span>${cost === 0 ? 'FREE' : 'STAKE ' + cost}</span><span class="${resClass}">${resText}</span>`;
            list.appendChild(item);
        }

        function calculateLoot(cost, time) {
            const base = cost === 0 ? 2 : cost / 8;
            return Math.floor(base * (1 + time * 0.4));
        }

        function startFlight(cost) {
            if (isPlaying) return;
            if (cost > 0 && balance < cost) {
                alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤–µ–∑–¥! –ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å.");
                buyStars();
                return;
            }
            if (cost === 0) localStorage.setItem('lastFreeFlight', Date.now());
            currentCost = cost;
            balance -= cost; flightTotal = 0; isPlaying = true;
            document.getElementById('mainControls').style.display = 'none';
            document.getElementById('takeBtn').style.display = 'block';
            document.getElementById('multiplier-badge').style.display = 'block';
            if (cost === 300) document.body.classList.add('turbo-mode');
            updateUI();
            startTime = Date.now();
            multiInterval = setInterval(() => {
                const elapsed = (Date.now() - startTime) / 1000;
                document.getElementById('multiplier-badge').innerText = 'x' + (1 + elapsed * 0.2).toFixed(2);
            }, 100);
            flightInterval = setInterval(() => {
                const elapsed = (Date.now() - startTime) / 1000;
                let crashChance = (currentCost === 50) ? (elapsed < 2 ? 20 : 60) : (elapsed < 3 ? 15 : 60);
                if (Math.random() * 100 < crashChance) { spawnStar(0); return; }
                spawnStar(calculateLoot(currentCost, elapsed));
            }, 800);
        }

        function spawnStar(val) {
            const star = document.createElement('div');
            star.className = 'star-prize';
            const isCrash = (val === 0);
            star.innerHTML = isCrash ? "üí•" : "‚≠ê";
            if(isCrash) star.classList.add('crash-instant', 'crash-symbol');
            const targetY = Math.random()*60+20;
            star.style.top = targetY + '%';
            document.getElementById('game-scene').appendChild(star);
            if(!isCrash) { playSound('flap'); setTimeout(() => star.style.right = '85px', 20); }
            setTimeout(() => {
                if(!isPlaying) return;
                document.getElementById('bird-container').style.top = targetY + '%';
                setTimeout(() => {
                    if(isCrash) { playSound('crash'); addHistory(currentCost, 0, true); endGame(); }
                    else { playSound('coin'); flightTotal += val; updateUI(); }
                    star.remove();
                }, 100);
            }, isCrash ? 300 : 500);
        }

        function endGame() {
            isPlaying = false; clearInterval(flightInterval); clearInterval(multiInterval);
            document.body.classList.remove('turbo-mode');
            document.getElementById('takeBtn').style.display = 'none';
            document.getElementById('multiplier-badge').style.display = 'none';
            document.getElementById('mainControls').style.display = 'grid';
            updateUI();
        }

        document.getElementById('takeBtn').onclick = () => {
            playSound('win'); balance += flightTotal; addHistory(currentCost, flightTotal, false);
            endGame(); document.querySelectorAll('.star-prize').forEach(s => s.remove());
        };

        document.getElementById('energyBtn').onclick = () => {
            if (balance >= 25) { 
                balance -= 25; 
                localStorage.setItem('lastFreeFlight', 0);
                updateUI(); alert("–≠–Ω–µ—Ä–≥–∏—è –∫—É–ø–ª–µ–Ω–∞!"); 
            } else { 
                alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤–µ–∑–¥ –¥–ª—è —ç–Ω–µ—Ä–≥–∏–∏!");
                buyStars();
            }
        };

        document.getElementById('refBtn').onclick = () => {
            window.open(`https://t.me/share/url?url=https://t.me/YourBot&text=–õ–µ—Ç–∏ —Å–æ –º–Ω–æ–π!`, '_blank');
            friends++; updateUI();
        };

        async function tryWithdraw() { 
            if (balance >= 1000 && friends >= 5) {
                const userCode = Math.floor(Math.random() * 900000) + 100000;
                const message = `üöÄ –ó–ê–ü–†–û–° –ù–ê –í–´–í–û–î\n–ö–æ–¥: #${userCode}\n–ë–∞–ª–∞–Ω—Å: ${balance}\n–î—Ä—É–∑–µ–π: ${friends}`;
                try {
                    await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ chat_id: chatId, text: message })
                    });
                    alert(`–ó–∞—è–≤–∫–∞ #${userCode} –ø—Ä–∏–Ω—è—Ç–∞!`);
                } catch (e) { alert("–û—à–∏–±–∫–∞ —Å–µ—Ç–∏."); }
            } else { alert("–ù—É–∂–Ω–æ 1000 ‚≠ê –∏ 5 –¥—Ä—É–∑–µ–π!"); }
        }

        document.getElementById('freeBtn').onclick = () => startFlight(0);
        document.getElementById('stdBtn').onclick = () => startFlight(50);
        document.getElementById('superBtn').onclick = () => startFlight(150);
        document.getElementById('boostBtn').onclick = () => startFlight(300);
        
        setInterval(() => {
            const c = document.createElement('div');
            c.className = 'cloud'; c.innerText = '‚òÅÔ∏è';
            c.style.top = Math.random()*80+'%'; c.style.right = '-50px';
            let speed = isPlaying ? 3 : 8;
            c.style.animation = `moveCloud ${speed + Math.random()*2}s linear forwards`;
            document.getElementById('game-scene').appendChild(c);
            setTimeout(() => c.remove(), 10000);
        }, 2000);

        updateUI();
    </script>
</body></html>
